{% extends "base.html" %}
{% block title %}My Attendance - Teacher{% endblock %}
{% block content %}
<div class="mb-3">
    <h1>ğŸ“… My Attendance Records</h1>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h3>Attendance Summary</h3>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-3">
                <div class="stat-card present">
                    <div class="stat-value">{{ attendance_stats.present_count }}</div>
                    <div class="stat-label">âœ“ Days Present</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card absent">
                    <div class="stat-value">{{ attendance_stats.absent_count }}</div>
                    <div class="stat-label">âœ— Days Absent</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card late">
                    <div class="stat-value">{{ attendance_stats.late_count }}</div>
                    <div class="stat-label">â° Days Late</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card on-leave">
                    <div class="stat-value">{{ attendance_stats.on_leave_count }}</div>
                    <div class="stat-label">ğŸ–ï¸ Days On Leave</div>
                </div>
            </div>
        </div>
        <div class="mt-3 text-center">
            <h4>Overall Attendance: <span
                    class="badge badge-{% if attendance_stats.percentage >= 90 %}success{% elif attendance_stats.percentage >= 75 %}warning{% else %}danger{% endif %}"
                    style="font-size: 1.5rem;">{{ attendance_stats.percentage }}%</span></h4>
        </div>
    </div>
</div>

<!-- Filter Options -->
<div class="card mb-4">
    <div class="card-body">
        <form method="GET" class="row g-3">
            <div class="col-md-4">
                <label class="form-label">From Date</label>
                <input type="date" name="from_date" class="form-control" value="{{ from_date }}">
            </div>
            <div class="col-md-4">
                <label class="form-label">To Date</label>
                <input type="date" name="to_date" class="form-control" value="{{ to_date }}">
            </div>
            <div class="col-md-4 d-flex align-items-end">
                <button type="submit" class="btn btn-primary me-2">ğŸ” Filter</button>
                <a href="{{ url_for('teacher.my_attendance') }}" class="btn btn-secondary">ğŸ”„ Reset</a>
            </div>
        </form>
    </div>
</div>

<!-- Attendance Records -->
<div class="card">
    <div class="card-header">
        <h3>Attendance History</h3>
    </div>
    <div class="card-body">
        {% if attendance_records %}
        <div style="overflow-x: auto;">
            <table class="table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Batch</th>
                        <th>Status</th>
                        <th>Marked By</th>
                        <th>Remarks</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in attendance_records %}
                    <tr
                        style="{% if record.status == 'present' %}background-color: #e8f5e9;{% elif record.status == 'absent' %}background-color: #ffebee;{% elif record.status == 'late' %}background-color: #fff3e0;{% elif record.status == 'on_leave' %}background-color: #e3f2fd;{% endif %}">
                        <td>{{ record.attendance_date.strftime('%d %b %Y') }}</td>
                        <td>{{ record.batch_name }}</td>
                        <td>
                            {% if record.status == 'present' %}
                            <span class="badge badge-success">âœ“ Present</span>
                            {% elif record.status == 'absent' %}
                            <span class="badge badge-danger">âœ— Absent</span>
                            {% elif record.status == 'late' %}
                            <span class="badge badge-warning">â° Late</span>
                            {% elif record.status == 'on_leave' %}
                            <span class="badge badge-info">ğŸ–ï¸ On Leave</span>
                            {% endif %}
                        </td>
                        <td>{{ record.marked_by_name or 'System' }}</td>
                        <td>{{ record.remarks or '-' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-muted text-center">No attendance records found for the selected period.</p>
        {% endif %}
    </div>
</div>

<style>
    .stat-card {
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        margin-bottom: 10px;
    }

    .stat-card.present {
        background-color: #e8f5e9;
        border-left: 4px solid #4caf50;
    }

    .stat-card.absent {
        background-color: #ffebee;
        border-left: 4px solid #f44336;
    }

    .stat-card.late {
        background-color: #fff3e0;
        border-left: 4px solid #ff9800;
    }

    .stat-card.on-leave {
        background-color: #e3f2fd;
        border-left: 4px solid #2196f3;
    }

    .stat-value {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .stat-label {
        font-size: 0.9rem;
        color: #666;
    }
</style>

{% endblock %}