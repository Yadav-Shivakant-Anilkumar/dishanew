{% extends "base.html" %}

{% block title %}Student Dashboard - Disha Computer Classes{% endblock %}

{% block content %}
<!-- Compact Header with Avatar and Profile -->
<div class="d-flex justify-between align-center mb-3"
    style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 1.5rem; border-radius: 1rem; color: white;">
    <div class="d-flex align-center" style="gap: 1rem;">
        <!-- User Avatar -->
        <div
            style="width: 70px; height: 70px; border-radius: 50%; background: white; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold; color: #667eea; box-shadow: 0 4px 10px rgba(0,0,0,0.2);">
            {{ session.full_name[0].upper() }}
        </div>
        <div>
            <h2 style="margin: 0; color: white; font-size: 1.5rem;">Welcome, {{ session.full_name }}!</h2>
            <p style="margin: 0.25rem 0 0; opacity: 0.9; font-size: 0.9rem;">Student Dashboard</p>
        </div>
    </div>
    <a href="{{ url_for('student.profile') }}" class="btn btn-sm"
        style="background: white; color: #667eea; border: none;">
        <i class="fas fa-user"></i> My Profile
    </a>
</div>

<!-- Compact Statistics -->
<div class="grid grid-4 mb-3" style="gap: 1rem;">
    <div class="card" style="padding: 1rem; text-align: center; margin: 0; border-left: 4px solid #667eea;">
        <div style="font-size: 1.75rem; font-weight: 700; color: #667eea;">{{ stats.total_courses }}</div>
        <div style="font-size: 0.8rem; color: #6B7280; text-transform: uppercase; letter-spacing: 0.5px;">Courses</div>
    </div>
    <div class="card" style="padding: 1rem; text-align: center; margin: 0; border-left: 4px solid #10B981;">
        <div style="font-size: 1.75rem; font-weight: 700; color: #10B981;">â‚¹{{ "%.0f"|format(stats.total_fees) }}</div>
        <div style="font-size: 0.8rem; color: #6B7280; text-transform: uppercase; letter-spacing: 0.5px;">Total Fees
        </div>
    </div>
    <div class="card" style="padding: 1rem; text-align: center; margin: 0; border-left: 4px solid #F59E0B;">
        <div style="font-size: 1.75rem; font-weight: 700; color: #F59E0B;">â‚¹{{ "%.0f"|format(stats.paid_amount) }}</div>
        <div style="font-size: 0.8rem; color: #6B7280; text-transform: uppercase; letter-spacing: 0.5px;">Paid</div>
    </div>
    <div class="card" style="padding: 1rem; text-align: center; margin: 0; border-left: 4px solid #EF4444;">
        <div style="font-size: 1.75rem; font-weight: 700; color: #EF4444;">â‚¹{{ "%.0f"|format(stats.due_amount) }}</div>
        <div style="font-size: 0.8rem; color: #6B7280; text-transform: uppercase; letter-spacing: 0.5px;">Due</div>
    </div>
</div>

<!-- My Courses -->
<div class="card mb-3" style="padding: 1.25rem;">
    <div class="d-flex justify-between align-center" style="margin-bottom: 1rem;">
        <h3 style="margin: 0; font-size: 1.25rem;">ðŸ“š My Courses</h3>
        <a href="{{ url_for('student.enroll') }}" class="btn btn-primary btn-sm">
            <i class="fas fa-plus"></i> Enroll New
        </a>
    </div>
    {% if enrollments %}
    <div class="grid grid-2" style="gap: 1rem;">
        {% for enrollment in enrollments %}
        <div class="card" style="margin: 0; padding: 1rem; border-left: 4px solid #10B981;">
            <h4 style="margin: 0 0 0.5rem; font-size: 1.1rem;">{{ enrollment.course_name }}</h4>
            <div style="font-size: 0.9rem; color: #6B7280; line-height: 1.6;">
                <p style="margin: 0.25rem 0;"><strong>Batch:</strong> {{ enrollment.batch_name }}</p>
                <p style="margin: 0.25rem 0;"><strong>Schedule:</strong> {{ enrollment.schedule }}</p>
                <p style="margin: 0.25rem 0;"><strong>Timing:</strong> {{ enrollment.timing }}</p>
                <p style="margin: 0.25rem 0;"><strong>Start:</strong> {{ enrollment.start_date }}</p>
            </div>
            <span class="badge badge-{{ enrollment.status == 'active' and 'success' or 'warning' }}"
                style="margin-top: 0.5rem;">
                {{ enrollment.status }}
            </span>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-muted text-center" style="margin: 2rem 0;">
        No enrollments yet. <a href="{{ url_for('student.enroll') }}">Enroll in a course</a>
    </p>
    {% endif %}
</div>

<!-- Recent Attendance -->
<div class="card" style="padding: 1.25rem;">
    <div class="d-flex justify-between align-center" style="margin-bottom: 1rem;">
        <h3 style="margin: 0; font-size: 1.25rem;">âœ… Recent Attendance</h3>
        <a href="{{ url_for('student.attendance') }}" class="btn btn-outline btn-sm">View All</a>
    </div>
    {% if recent_attendance %}
    <div style="overflow-x: auto;">
        <table class="table" style="font-size: 0.9rem;">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Course</th>
                    <th>Batch</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for record in recent_attendance %}
                <tr>
                    <td>{{ record.attendance_date }}</td>
                    <td>{{ record.course_name }}</td>
                    <td>{{ record.batch_name }}</td>
                    <td>
                        <span
                            class="badge badge-{{ record.status == 'present' and 'success' or (record.status == 'late' and 'warning' or 'danger') }}">
                            {{ record.status }}
                        </span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p class="text-muted text-center" style="margin: 2rem 0;">No attendance records yet</p>
    {% endif %}
</div>
{% endblock %}